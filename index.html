<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Early Risk Signals - Credit Card Delinquency Watch</title>
    <link rel="stylesheet" href="website/workflow-styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Tab Styles */
        .tabs-container {
            background: #0f172a;
            border-bottom: 1px solid #1e293b;
            padding: 0;
        }
        
        .tabs {
            display: flex;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .tab {
            padding: 1rem 2rem;
            background: transparent;
            border: none;
            color: #9ca3af;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            position: relative;
        }
        
        .tab:hover {
            color: #e5e7eb;
            background: rgba(139, 0, 0, 0.1);
        }
        
        .tab.active {
            color: #e5e7eb;
            border-bottom-color: #8b0000;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Apply Form Styles */
        .apply-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 3rem 20px;
        }
        
        .form-container {
            background: #0f172a;
            border: 1px solid #1e293b;
            border-radius: 1rem;
            padding: 2.5rem;
            margin-bottom: 2rem;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-group label {
            font-size: 0.875rem;
            font-weight: 600;
            color: #e5e7eb;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .form-group input {
            background: #020617;
            border: 1px solid #1e293b;
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            color: #e5e7eb;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: #8b0000;
            box-shadow: 0 0 0 3px rgba(139, 0, 0, 0.1);
        }
        
        .form-group input:hover {
            border-color: #334155;
        }
        
        .submit-btn {
            background: #8b0000;
            color: white;
            border: none;
            padding: 1rem 3rem;
            border-radius: 0.5rem;
            font-size: 1.125rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 1rem;
        }
        
        .submit-btn:hover {
            background: #dc143c;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(139, 0, 0, 0.3);
        }
        
        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .result-container {
            background: #0f172a;
            border: 1px solid #1e293b;
            border-radius: 1rem;
            padding: 2.5rem;
            margin-top: 2rem;
            display: none;
        }
        
        .result-container.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .result-header {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: #e5e7eb;
            border-left: 4px solid #8b0000;
            padding-left: 1rem;
        }
        
        .result-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .result-card {
            background: #020617;
            border: 1px solid #1e293b;
            border-radius: 0.5rem;
            padding: 1.5rem;
            text-align: center;
        }
        
        .result-card.critical {
            border-left: 4px solid #dc143c;
        }
        
        .result-card.high {
            border-left: 4px solid #ef4444;
        }
        
        .result-card.medium {
            border-left: 4px solid #f59e0b;
        }
        
        .result-card.low {
            border-left: 4px solid #10b981;
        }
        
        .result-label {
            font-size: 0.875rem;
            color: #9ca3af;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
        }
        
        .result-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #e5e7eb;
        }
        
        .risk-flags {
            margin-top: 1.5rem;
        }
        
        .risk-flags h3 {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: #e5e7eb;
        }
        
        .flag-item {
            background: #020617;
            border: 1px solid #1e293b;
            border-left: 4px solid #8b0000;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 0.75rem;
        }
        
        .flag-item strong {
            color: #e5e7eb;
            display: block;
            margin-bottom: 0.5rem;
        }
        
        .flag-item span {
            color: #9ca3af;
            font-size: 0.875rem;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 2rem;
            color: #9ca3af;
        }
        
        .loading.show {
            display: block;
        }
        
        .error-message {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid #ef4444;
            border-radius: 0.5rem;
            padding: 1rem;
            color: #ef4444;
            margin-top: 1rem;
            display: none;
        }
        
        .error-message.show {
            display: block;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="workflow-header">
        <div class="container">
            <h1>Early Risk Signals - Credit Card Delinquency Watch</h1>
            <p>Complete workflow visualization and risk prediction system</p>
        </div>
    </header>

    <!-- Tabs -->
    <div class="tabs-container">
        <div class="tabs">
            <button class="tab active" onclick="switchTab('workflow')">Workflow</button>
            <button class="tab" onclick="switchTab('apply')">Apply Here</button>
            <button class="tab" onclick="window.location.href='interactive-dashboard.html'">Interactive Dashboard</button>
        </div>
    </div>

    <!-- Workflow Tab Content -->
    <div id="workflow-tab" class="tab-content active">
        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>

        <!-- Workflow Steps -->
        <div class="workflow-container">
            
            <!-- Step 1: Data Loading -->
            <div class="workflow-step" data-step="1">
                <div class="step-header">
                    <div class="step-number">01</div>
                    <div class="step-content">
                        <h2>Data Loading & Initial Analysis</h2>
                        <p class="step-subtitle">Understanding the dataset structure and characteristics</p>
                    </div>
                </div>
                <div class="step-details">
                    <div class="detail-section">
                        <h3>What We Did</h3>
                        <ul>
                            <li>Loaded <strong>Sample.csv</strong> containing 100 customer records</li>
                            <li>Analyzed 9 features: Customer ID, Credit Limit, Utilization %, Payment metrics, etc.</li>
                            <li>Identified target variable: <strong>DPD Bucket Next Month</strong> (0-3 scale)</li>
                            <li>Discovered class imbalance: 75% no risk, 25% at-risk</li>
                        </ul>
                    </div>
                    <div class="detail-section">
                        <h3>How We Did It</h3>
                        <div class="code-block">
                            <pre><code># Load data using pandas
df = pd.read_csv('Sample.csv')

# Analyze structure
print(f"Shape: {df.shape}")
print(f"Columns: {df.columns.tolist()}")
print(f"Target distribution: {df['DPD Bucket'].value_counts()}")

# Result: 100 rows × 9 columns</code></pre>
                        </div>
                    </div>
                    <div class="detail-section">
                        <h3>Key Findings</h3>
                        <div class="findings-grid">
                            <div class="finding-card">
                                <div class="finding-value">100</div>
                                <div class="finding-label">Customer Records</div>
                            </div>
                            <div class="finding-card">
                                <div class="finding-value">9</div>
                                <div class="finding-label">Features</div>
                            </div>
                            <div class="finding-card">
                                <div class="finding-value">75%</div>
                                <div class="finding-label">No Risk</div>
                            </div>
                            <div class="finding-card">
                                <div class="finding-value">25%</div>
                                <div class="finding-label">At-Risk</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 2: Feature Engineering -->
            <div class="workflow-step" data-step="2">
                <div class="step-header">
                    <div class="step-number">02</div>
                    <div class="step-content">
                        <h2>Feature Engineering - Early Warning Signals</h2>
                        <p class="step-subtitle">Creating 14+ behavioral indicators that precede delinquency</p>
                    </div>
                </div>
                <div class="step-details">
                    <div class="detail-section">
                        <h3>What We Did</h3>
                        <p>Engineered <strong>14+ new features</strong> from original data to create early warning signals:</p>
                        <div class="features-grid">
                            <div class="feature-card">
                                <h4>1. Spending Behavior Signals</h4>
                                <ul>
                                    <li><code>spending_decline_flag</code>: Binary (1 if spending change < -15%)</li>
                                    <li><code>spending_stress</code>: 0-2 scale (0=normal, 1=moderate, 2=severe)</li>
                                </ul>
                            </div>
                            <div class="feature-card">
                                <h4>2. Utilization Risk Signals</h4>
                                <ul>
                                    <li><code>high_utilization_flag</code>: Binary (1 if utilization ≥ 80%)</li>
                                    <li><code>utilization_risk</code>: 0-3 scale (0=low, 3=critical)</li>
                                </ul>
                            </div>
                            <div class="feature-card">
                                <h4>3. Payment Behavior Signals</h4>
                                <ul>
                                    <li><code>low_payment_frequency</code>: Binary (1 if frequency < 30%)</li>
                                    <li><code>payment_stress</code>: 0-2 scale</li>
                                    <li><code>payment_risk_ratio</code>: Payment frequency / Utilization</li>
                                </ul>
                            </div>
                            <div class="feature-card">
                                <h4>4. Cash Withdrawal Signals</h4>
                                <ul>
                                    <li><code>high_cash_withdrawal</code>: Binary (1 if ≥ 15%)</li>
                                    <li><code>cash_stress_indicator</code>: 0-2 scale</li>
                                </ul>
                            </div>
                            <div class="feature-card">
                                <h4>5. Composite Risk Signals</h4>
                                <ul>
                                    <li><code>utilization_payment_mismatch</code>: High util + Low payment</li>
                                    <li><code>spending_utilization_stress</code>: Spending decline + High util</li>
                                    <li><code>payment_utilization_critical</code>: Low payment + High util</li>
                                </ul>
                            </div>
                            <div class="feature-card">
                                <h4>6. Early Risk Score</h4>
                                <ul>
                                    <li>Weighted combination of all signals</li>
                                    <li>Normalized to 0.0-1.0 scale</li>
                                    <li>Formula: (Spending×0.25 + Utilization×0.30 + Payment×0.25 + Cash×0.10 + Merchant×0.10) / 3.0</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="detail-section">
                        <h3>How We Did It</h3>
                        <div class="code-block">
                            <pre><code># Example: Spending Stress Calculation
df['spending_stress'] = np.where(
    df['Recent Spend Change %'] < -20, 2,  # Severe
    np.where(df['Recent Spend Change %'] < -10, 1, 0)  # Moderate
)

# Example: Utilization Risk
df['utilization_risk'] = np.where(
    df['Utilisation %'] >= 90, 3,  # Critical
    np.where(df['Utilisation %'] >= 70, 2,  # High
    np.where(df['Utilisation %'] >= 50, 1, 0))  # Medium/Low
)

# Early Risk Score Calculation
df['early_risk_score'] = (
    df['spending_stress'] * 0.25 +
    df['utilization_risk'] * 0.30 +
    df['payment_stress'] * 0.25 +
    df['cash_stress_indicator'] * 0.10 +
    df['narrow_merchant_mix'] * 0.10
) / 3.0</code></pre>
                        </div>
                    </div>
                    <div class="detail-section">
                        <h3>Output</h3>
                        <p>Enhanced dataset with <strong>23+ columns</strong> (original 9 + 14+ engineered features)</p>
                    </div>
                </div>
            </div>

            <!-- Step 3: Risk Flag Generation -->
            <div class="workflow-step" data-step="3">
                <div class="step-header">
                    <div class="step-number">03</div>
                    <div class="step-content">
                        <h2>Risk Flag Generation</h2>
                        <p class="step-subtitle">Creating deterministic flags with clear business logic</p>
                    </div>
                </div>
                <div class="step-details">
                    <div class="detail-section">
                        <h3>What We Did</h3>
                        <p>Generated risk flags for each customer based on <strong>deterministic thresholds</strong>:</p>
                        <div class="flags-list">
                            <div class="flag-item collapsible" onclick="toggleFlag(this)">
                                <div class="flag-header">
                                    <div class="flag-title">
                                        <strong>SPENDING_DECLINE_SEVERE</strong>
                                        <span class="flag-trigger">Trigger: Spending change < -20%</span>
                                        <span class="flag-severity-badge high">HIGH</span>
                                    </div>
                                    <span class="expand-icon">▼</span>
                                </div>
                                <div class="flag-details">
                                    <p>This flag is created by analyzing the customer's recent spending behavior compared to their historical patterns. The system calculates the percentage change in spending by comparing the current month's total spending to previous periods. When a customer's spending drops by more than 20%, it indicates potential financial distress or a significant change in their financial situation. This threshold was chosen based on industry research showing that spending declines of this magnitude often precede payment difficulties. The flag is assigned a HIGH severity because sudden spending reductions can signal cash flow problems, job loss, or other financial hardships that may lead to delinquency. The system generates a personalized message showing the exact percentage decline, which helps customer service representatives understand the severity of the situation when reaching out to the customer.</p>
                                </div>
                            </div>
                            <div class="flag-item collapsible" onclick="toggleFlag(this)">
                                <div class="flag-header">
                                    <div class="flag-title">
                                        <strong>CRITICAL_UTILIZATION</strong>
                                        <span class="flag-trigger">Trigger: Utilization ≥ 90%</span>
                                        <span class="flag-severity-badge high">HIGH</span>
                                    </div>
                                    <span class="expand-icon">▼</span>
                                </div>
                                <div class="flag-details">
                                    <p>This flag monitors the customer's credit utilization ratio, which is calculated by dividing the current outstanding balance by the total credit limit and multiplying by 100. When utilization reaches or exceeds 90%, it means the customer is using nearly all of their available credit. This is a critical indicator because high utilization not only suggests financial stress but also leaves little room for unexpected expenses. The 90% threshold was selected as it represents a critical point where customers have minimal credit buffer and are at high risk of exceeding their limit or missing payments. The system tracks this metric continuously and flags customers who cross this threshold. When this flag is triggered, the system generates an alert message showing the exact utilization percentage, enabling immediate intervention. This flag is classified as HIGH severity because customers at this utilization level are statistically more likely to become delinquent within the next billing cycle.</p>
                                </div>
                            </div>
                            <div class="flag-item collapsible" onclick="toggleFlag(this)">
                                <div class="flag-header">
                                    <div class="flag-title">
                                        <strong>LOW_PAYMENT_FREQUENCY</strong>
                                        <span class="flag-trigger">Trigger: Payment frequency < 20%</span>
                                        <span class="flag-severity-badge high">HIGH</span>
                                    </div>
                                    <span class="expand-icon">▼</span>
                                </div>
                                <div class="flag-details">
                                    <p>This flag is generated by analyzing the customer's payment history over multiple billing cycles. The system calculates the percentage of times the customer has paid at least the minimum due amount on time. The payment frequency is computed by dividing the number of on-time minimum payments by the total number of billing cycles analyzed, then multiplying by 100. When this frequency drops below 20%, it means the customer is making timely minimum payments less than one-fifth of the time. This threshold indicates a pattern of inconsistent payment behavior that often precedes delinquency. The 20% threshold was chosen because customers who pay on time less than 20% of the time show a clear pattern of payment difficulties. The system tracks this metric across rolling windows to identify trends. When triggered, the flag includes the exact payment frequency percentage, helping identify customers who may need payment assistance programs or structured payment plans. This is classified as HIGH severity because payment frequency is one of the strongest predictors of future delinquency.</p>
                                </div>
                            </div>
                            <div class="flag-item collapsible" onclick="toggleFlag(this)">
                                <div class="flag-header">
                                    <div class="flag-title">
                                        <strong>PAYMENT_UTILIZATION_CRITICAL</strong>
                                        <span class="flag-trigger">Trigger: Low payment (<30%) + High util (>70%)</span>
                                        <span class="flag-severity-badge critical">CRITICAL</span>
                                    </div>
                                    <span class="expand-icon">▼</span>
                                </div>
                                <div class="flag-details">
                                    <p>This is a composite flag that combines two critical risk indicators: low payment frequency and high credit utilization. The flag is triggered when both conditions are met simultaneously: the customer's payment frequency is below 30% AND their credit utilization exceeds 70%. This combination is particularly dangerous because it indicates customers who are using most of their available credit while also struggling to make regular payments. The system creates this flag by first checking if the payment frequency metric falls below the 30% threshold, which indicates inconsistent payment behavior. Then it checks if the utilization ratio exceeds 70%, showing high credit usage. When both conditions are true, the system generates this CRITICAL severity flag. The thresholds were chosen based on statistical analysis showing that customers meeting both criteria have a significantly higher probability of becoming delinquent within 30-60 days. This composite approach allows the system to identify customers who are in the most precarious financial position, requiring immediate intervention. The flag triggers urgent outreach strategies, including phone calls within 24 hours and offers of payment plans or hardship programs.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="detail-section">
                        <h3>How We Did It</h3>
                        <div class="code-block">
                            <pre><code># Flag Generation Logic
for idx, row in df.iterrows():
    customer_flags = []
    
    # Check spending decline
    if row['Recent Spend Change %'] < -20:
        customer_flags.append({
            'flag': 'SPENDING_DECLINE_SEVERE',
            'severity': 'HIGH',
            'message': f"Spending dropped {abs(row['Recent Spend Change %'])}%",
            'action': 'Proactive payment plan discussion'
        })
    
    # Check utilization
    if row['Utilisation %'] >= 90:
        customer_flags.append({
            'flag': 'CRITICAL_UTILIZATION',
            'severity': 'HIGH',
            'message': f"Credit utilization at {row['Utilisation %']}%",
            'action': 'Immediate credit limit review'
        })
    
    # Determine overall risk level
    if any(f['severity'] == 'CRITICAL' for f in customer_flags):
        risk_level = 'CRITICAL'
    elif any(f['severity'] == 'HIGH' for f in customer_flags):
        risk_level = 'HIGH'
    # ... etc</code></pre>
                        </div>
                    </div>
                    <div class="detail-section">
                        <h3>Results</h3>
                        <div class="results-grid">
                            <div class="result-card">
                                <div class="result-value">50</div>
                                <div class="result-label">Customers Flagged</div>
                            </div>
                            <div class="result-card">
                                <div class="result-value">10</div>
                                <div class="result-label">CRITICAL Risk</div>
                            </div>
                            <div class="result-card">
                                <div class="result-value">40</div>
                                <div class="result-label">HIGH Risk</div>
                            </div>
                            <div class="result-card">
                                <div class="result-value">23</div>
                                <div class="result-label">Top Flag Count</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 4: Model Training -->
            <div class="workflow-step" data-step="4">
                <div class="step-header">
                    <div class="step-number">04</div>
                    <div class="step-content">
                        <h2>Predictive Model Training</h2>
                        <p class="step-subtitle">Training multiple ML models to validate early signals</p>
                    </div>
                </div>
                <div class="step-details">
                    <div class="detail-section">
                        <h3>What We Did</h3>
                        <p>Trained <strong>3 machine learning models</strong> to predict at-risk customers:</p>
                        <div class="models-grid">
                            <div class="model-card">
                                <h4>1. Random Forest</h4>
                                <ul>
                                    <li>100 estimators</li>
                                    <li>Max depth: 5</li>
                                    <li>Class weight: balanced</li>
                                    <li><strong>Accuracy: 75%</strong></li>
                                </ul>
                            </div>
                            <div class="model-card">
                                <h4>2. Logistic Regression</h4>
                                <ul>
                                    <li>L2 regularization</li>
                                    <li>Class weight: balanced</li>
                                    <li>Max iterations: 1000</li>
                                    <li><strong>Accuracy: 55%</strong></li>
                                </ul>
                            </div>
                            <div class="model-card">
                                <h4>3. Gradient Boosting</h4>
                                <ul>
                                    <li>100 estimators</li>
                                    <li>Max depth: 3</li>
                                    <li>Learning rate: default</li>
                                    <li><strong>Accuracy: 65%</strong></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="detail-section">
                        <h3>How We Did It</h3>
                        <div class="code-block">
                            <pre><code># Prepare features
feature_cols = [
    'Utilisation %', 'Avg Payment Ratio', 'Min Due Paid Frequency',
    'Merchant Mix Index', 'Cash Withdrawal %', 'Recent Spend Change %',
    'spending_stress', 'utilization_risk', 'payment_stress',
    'cash_stress_indicator', 'utilization_payment_mismatch',
    'spending_utilization_stress', 'payment_utilization_critical'
]

X = df[feature_cols]
y = (df['DPD Bucket Next Month'] > 0).astype(int)  # Binary target

# Train-test split (80/20)
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42, stratify=y
)

# Scale features
scaler = StandardScaler()
X_train_scaled = scaler.fit_transform(X_train)
X_test_scaled = scaler.transform(X_test)

# Train Random Forest
model = RandomForestClassifier(
    n_estimators=100,
    max_depth=5,
    min_samples_split=10,
    random_state=42,
    class_weight='balanced'
)
model.fit(X_train_scaled, y_train)

# Evaluate
y_pred = model.predict(X_test_scaled)
accuracy = accuracy_score(y_test, y_pred)</code></pre>
                        </div>
                    </div>
                    <div class="detail-section">
                        <h3>Top Features</h3>
                        <ol class="feature-list">
                            <li>Min Due Paid Frequency (18.3% importance)</li>
                            <li>Utilisation % (17.5% importance)</li>
                            <li>Recent Spend Change % (13.7% importance)</li>
                            <li>Avg Payment Ratio (11.7% importance)</li>
                            <li>Merchant Mix Index (11.2% importance)</li>
                        </ol>
                    </div>
                </div>
            </div>

            <!-- Step 5: Outreach Strategies -->
            <div class="workflow-step" data-step="5">
                <div class="step-header">
                    <div class="step-number">05</div>
                    <div class="step-content">
                        <h2>Outreach Strategy Generation</h2>
                        <p class="step-subtitle">Creating actionable intervention plans for each customer</p>
                    </div>
                </div>
                <div class="step-details">
                    <div class="detail-section">
                        <h3>What We Did</h3>
                        <p>Generated <strong>personalized outreach strategies</strong> based on risk level:</p>
                        
                        <!-- Dynamic Controls Panel -->
                        <div class="strategy-controls">
                            <h4>Adjust Outreach Parameters</h4>
                            <div class="controls-grid">
                                <div class="control-group">
                                    <label for="critical-timing">CRITICAL Risk Timing (hours):</label>
                                    <input type="number" id="critical-timing" min="1" max="168" value="24" step="1">
                                    <span class="control-hint">Default: 24 hours</span>
                                </div>
                                <div class="control-group">
                                    <label for="critical-channel">CRITICAL Risk Channel:</label>
                                    <select id="critical-channel">
                                        <option value="Phone Call">Phone Call</option>
                                        <option value="Phone Call or Email">Phone Call or Email</option>
                                        <option value="Email">Email</option>
                                        <option value="SMS">SMS</option>
                                    </select>
                                </div>
                                <div class="control-group">
                                    <label for="high-timing">HIGH Risk Timing (hours):</label>
                                    <input type="number" id="high-timing" min="1" max="168" value="48" step="1">
                                    <span class="control-hint">Default: 48 hours</span>
                                </div>
                                <div class="control-group">
                                    <label for="high-channel">HIGH Risk Channel:</label>
                                    <select id="high-channel">
                                        <option value="Phone Call or Email">Phone Call or Email</option>
                                        <option value="Phone Call">Phone Call</option>
                                        <option value="Email">Email</option>
                                        <option value="SMS">SMS</option>
                                    </select>
                                </div>
                                <div class="control-group">
                                    <label for="medium-timing">MEDIUM Risk Timing (hours):</label>
                                    <input type="number" id="medium-timing" min="1" max="168" value="168" step="1">
                                    <span class="control-hint">Default: 168 hours (1 week)</span>
                                </div>
                                <div class="control-group">
                                    <label for="medium-channel">MEDIUM Risk Channel:</label>
                                    <select id="medium-channel">
                                        <option value="Email or SMS">Email or SMS</option>
                                        <option value="Email">Email</option>
                                        <option value="SMS">SMS</option>
                                        <option value="Phone Call">Phone Call</option>
                                    </select>
                                </div>
                            </div>
                            <div class="control-buttons">
                                <button class="change-btn" onclick="updateStrategies()">Change</button>
                                <button class="reset-btn" onclick="resetStrategies()">Reset to Defaults</button>
                            </div>
                        </div>
                        
                        <div class="strategy-grid">
                            <div class="strategy-card critical">
                                <h4>CRITICAL Risk</h4>
                                <ul>
                                    <li><strong>Channel:</strong> <span id="critical-channel-display">Phone Call</span></li>
                                    <li><strong>Timing:</strong> <span id="critical-timing-display">Within 24 hours</span></li>
                                    <li><strong>Message:</strong> Urgent intervention required</li>
                                    <li><strong>Offer:</strong> Payment plan, hardship program</li>
                                </ul>
                                <div class="strategy-count">10 customers</div>
                            </div>
                            <div class="strategy-card high">
                                <h4>HIGH Risk</h4>
                                <ul>
                                    <li><strong>Channel:</strong> <span id="high-channel-display">Phone Call or Email</span></li>
                                    <li><strong>Timing:</strong> <span id="high-timing-display">Within 48 hours</span></li>
                                    <li><strong>Message:</strong> Proactive support offer</li>
                                    <li><strong>Offer:</strong> Payment plan, counseling</li>
                                </ul>
                                <div class="strategy-count">40 customers</div>
                            </div>
                            <div class="strategy-card medium">
                                <h4>MEDIUM Risk</h4>
                                <ul>
                                    <li><strong>Channel:</strong> <span id="medium-channel-display">Email or SMS</span></li>
                                    <li><strong>Timing:</strong> <span id="medium-timing-display">Within 1 week</span></li>
                                    <li><strong>Message:</strong> Educational resources</li>
                                    <li><strong>Offer:</strong> Tips and reminders</li>
                                </ul>
                                <div class="strategy-count">19 customers</div>
                            </div>
                        </div>
                    </div>
                    <div class="detail-section">
                        <h3>How We Did It</h3>
                        <div class="code-block">
                            <pre><code># Strategy Generation with Dynamic Parameters
# Configuration parameters (adjustable by administrators)
OUTREACH_CONFIG = {
    'CRITICAL': {
        'timing_hours': 24,  # Default: 24 hours (adjustable 1-168)
        'channel': 'Phone Call'  # Default: Phone Call (adjustable)
    },
    'HIGH': {
        'timing_hours': 48,  # Default: 48 hours (adjustable 1-168)
        'channel': 'Phone Call or Email'  # Default: Phone Call or Email (adjustable)
    },
    'MEDIUM': {
        'timing_hours': 168,  # Default: 168 hours / 1 week (adjustable 1-168)
        'channel': 'Email or SMS'  # Default: Email or SMS (adjustable)
    }
}

def format_timing(hours):
    """Format hours into human-readable timing string"""
    if hours < 24:
        return f'Within {hours} hour{"s" if hours > 1 else ""}'
    elif hours < 168:
        days = hours // 24
        remaining_hours = hours % 24
        if remaining_hours == 0:
            return f'Within {days} day{"s" if days > 1 else ""}'
        else:
            return f'Within {days} day{"s" if days > 1 else ""} and {remaining_hours} hour{"s" if remaining_hours > 1 else ""}'
    else:
        weeks = hours // 168
        remaining_days = (hours % 168) // 24
        if remaining_days == 0:
            return f'Within {weeks} week{"s" if weeks > 1 else ""}'
        else:
            return f'Within {weeks} week{"s" if weeks > 1 else ""} and {remaining_days} day{"s" if remaining_days > 1 else ""}'

for idx, row in risk_flags_df.iterrows():
    strategies = []
    risk_level = row['risk_level']
    
    # Base strategy by risk level (using dynamic config)
    if risk_level == 'CRITICAL':
        config = OUTREACH_CONFIG['CRITICAL']
        strategies.append({
            'priority': 1,
            'channel': config['channel'],  # Dynamic: from config
            'timing': format_timing(config['timing_hours']),  # Dynamic: formatted timing
            'message': 'Urgent: We noticed concerning patterns in your account. Let\'s discuss payment options.',
            'offer': 'Payment plan, hardship program, or credit limit adjustment'
        })
    elif risk_level == 'HIGH':
        config = OUTREACH_CONFIG['HIGH']
        strategies.append({
            'priority': 2,
            'channel': config['channel'],  # Dynamic: from config
            'timing': format_timing(config['timing_hours']),  # Dynamic: formatted timing
            'message': 'We\'re here to help. Let\'s review your account and explore options.',
            'offer': 'Payment plan or financial counseling'
        })
    elif risk_level == 'MEDIUM':
        config = OUTREACH_CONFIG['MEDIUM']
        strategies.append({
            'priority': 3,
            'channel': config['channel'],  # Dynamic: from config
            'timing': format_timing(config['timing_hours']),  # Dynamic: formatted timing
            'message': 'Tips for managing your credit card account effectively.',
            'offer': 'Educational resources and payment reminders'
        })
    
    # Flag-specific strategies
    for flag in row['flags']:
        if flag['flag'] == 'SPENDING_DECLINE_SEVERE':
            strategies.append({
                'priority': 1,
                'channel': 'Phone Call',
                'timing': format_timing(OUTREACH_CONFIG[risk_level]['timing_hours']),
                'message': 'We noticed a significant change in your spending patterns.',
                'offer': 'Financial wellness check-in and budgeting tools'
            })
    
    return strategies</code></pre>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 6: Visualizations -->
            <div class="workflow-step" data-step="6">
                <div class="step-header">
                    <div class="step-number">06</div>
                    <div class="step-content">
                        <h2>Visualization Creation</h2>
                        <p class="step-subtitle">Generating 9 comprehensive charts and dashboards</p>
                    </div>
                </div>
                <div class="step-details">
                    <div class="detail-section">
                        <h3>What We Did</h3>
                        <p>Created <strong>9 professional visualizations</strong> using matplotlib and seaborn:</p>
                    </div>
                    
                    <!-- Visualization 1: Model Comparison -->
                    <div class="detail-section">
                        <h3>1. Model Performance Comparison</h3>
                        <p>Comparison of three machine learning models showing accuracy and ROC-AUC scores.</p>
                        <div class="viz-image-container">
                            <img src="../visualizations/model_comparison.png" alt="Model Comparison" class="workflow-viz-image">
                        </div>
                        <p class="viz-description">Line graphs comparing Random Forest, Logistic Regression, and Gradient Boosting models. Random Forest achieved the highest accuracy of 75%.</p>
                    </div>

                    <!-- Visualization 2: Dataset Comparison -->
                    <div class="detail-section">
                        <h3>2. Dataset Size Impact Analysis</h3>
                        <p>Performance comparison between original dataset (100 records) and synthetic dataset (50,000 records).</p>
                        <div class="viz-image-container">
                            <img src="visualizations/dataset_comparison.png" alt="Dataset Comparison" class="workflow-viz-image">
                        </div>
                        <p class="viz-description">Shows how model performance changes with dataset size. Gradient Boosting improved significantly with larger dataset, achieving 79% accuracy.</p>
                    </div>

                    <!-- Visualization 3: Risk Distribution -->
                    <div class="detail-section">
                        <h3>3. Portfolio Risk Distribution</h3>
                        <p>Distribution of risk levels across the customer portfolio.</p>
                        <div class="viz-image-container">
                            <img src="visualizations/risk_distribution.png" alt="Risk Distribution" class="workflow-viz-image">
                        </div>
                        <p class="viz-description">Bar chart showing risk level breakdown and histogram of risk score distribution. 50% of customers flagged as at-risk.</p>
                    </div>

                    <!-- Visualization 4: Behavioral Patterns -->
                    <div class="detail-section">
                        <h3>4. Behavioral Pattern Analysis</h3>
                        <p>Key behavioral patterns that precede delinquency.</p>
                        <div class="viz-image-container">
                            <img src="visualizations/behavioral_patterns.png" alt="Behavioral Patterns" class="workflow-viz-image">
                        </div>
                        <p class="viz-description">Four scatter plots showing correlations: Spending Change vs Utilization, Payment Frequency vs Utilization, Cash Withdrawal patterns, and Early Risk Score by DPD bucket.</p>
                    </div>

                    <!-- Visualization 5: Flag Frequency -->
                    <div class="detail-section">
                        <h3>5. Early Warning Flag Frequency</h3>
                        <p>Most common early warning signals across the portfolio.</p>
                        <div class="viz-image-container">
                            <img src="visualizations/flag_frequency.png" alt="Flag Frequency" class="workflow-viz-image">
                        </div>
                        <p class="viz-description">Horizontal bar chart showing frequency of each risk flag. Low Payment Frequency (23 customers) and Spending Decline (20 customers) are top indicators.</p>
                    </div>

                    <!-- Visualization 6: Feature Importance -->
                    <div class="detail-section">
                        <h3>6. Feature Importance Analysis</h3>
                        <p>Top predictive features from the Random Forest model.</p>
                        <div class="viz-image-container">
                            <img src="visualizations/feature_importance.png" alt="Feature Importance" class="workflow-viz-image">
                        </div>
                        <p class="viz-description">Bar chart showing top 10 most important features. Payment Frequency (18.3%) and Utilization (17.5%) are strongest predictors.</p>
                    </div>

                    <!-- Visualization 7: Outreach Strategy -->
                    <div class="detail-section">
                        <h3>7. Outreach Strategy Distribution</h3>
                        <p>Distribution of intervention strategies by channel and priority level.</p>
                        <div class="viz-image-container">
                            <img src="visualizations/outreach_strategy.png" alt="Outreach Strategy" class="workflow-viz-image">
                        </div>
                        <p class="viz-description">Bar charts showing outreach channel distribution and intervention priority levels. 10 customers require immediate phone calls.</p>
                    </div>

                    <!-- Visualization 8: Risk Heatmap -->
                    <div class="detail-section">
                        <h3>8. Risk Factors Correlation Heatmap</h3>
                        <p>Correlation matrix showing relationships between different risk factors.</p>
                        <div class="viz-image-container">
                            <img src="visualizations/risk_heatmap.png" alt="Risk Heatmap" class="workflow-viz-image">
                        </div>
                        <p class="viz-description">Heatmap showing correlations between 10 key risk factors. Strong correlations help identify which factors work together to predict delinquency.</p>
                    </div>

                    <!-- Visualization 9: Workflow Diagram -->
                    <div class="detail-section">
                        <h3>9. System Workflow Diagram</h3>
                        <p>Complete workflow of the Early Risk Signal System.</p>
                        <div class="viz-image-container">
                            <img src="visualizations/workflow_diagram.png" alt="Workflow Diagram" class="workflow-viz-image">
                        </div>
                        <p class="viz-description">Visual workflow showing data flow from input through risk flag generation to automated outreach strategies. Shows decision tree routing for different risk levels.</p>
                    </div>

                    <div class="detail-section">
                        <h3>How We Did It</h3>
                        <div class="code-block">
                            <pre><code># Example: Risk Distribution Chart
fig, axes = plt.subplots(1, 2, figsize=(16, 6))

# Risk level distribution
risk_counts = risk_flags_df['risk_level'].value_counts()
axes[0].bar(risk_counts.index, risk_counts.values, 
           color=['green', 'orange', 'red', 'darkred'])

# Risk score distribution
axes[1].hist(risk_flags_df['risk_score'], bins=20, color='blue')
axes[1].axvline(risk_flags_df['risk_score'].mean(), 
               color='red', linestyle='--')

plt.savefig('risk_distribution.png', dpi=300)</code></pre>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 7: Output Generation -->
            <div class="workflow-step" data-step="7">
                <div class="step-header">
                    <div class="step-number">07</div>
                    <div class="step-content">
                        <h2>Output Files & Documentation</h2>
                        <p class="step-subtitle">Generating comprehensive outputs and documentation</p>
                    </div>
                </div>
                <div class="step-details">
                    <div class="detail-section">
                        <h3>What We Created</h3>
                        <div class="outputs-grid">
                            <div class="output-card">
                                <h4>CSV Files (3)</h4>
                                <ul>
                                    <li><code>risk_flags_output.csv</code> - Risk flags for 100 customers</li>
                                    <li><code>outreach_strategies.csv</code> - Intervention recommendations</li>
                                    <li><code>data_with_early_signals.csv</code> - Enhanced dataset</li>
                                </ul>
                            </div>
                            <div class="output-card">
                                <h4>Visualizations (9)</h4>
                                <ul>
                                    <li>All PNG files saved with 300 DPI</li>
                                    <li>Professional styling and formatting</li>
                                    <li>Ready for presentations</li>
                                </ul>
                            </div>
                            <div class="output-card">
                                <h4>Documentation (5)</h4>
                                <ul>
                                    <li><code>README.md</code> - User guide</li>
                                    <li><code>solution_narrative.md</code> - Complete documentation</li>
                                    <li><code>EXECUTIVE_SUMMARY.md</code> - Executive overview</li>
                                    <li><code>FULL_WORKFLOW.md</code> - Workflow details</li>
                                    <li><code>EXECUTION_TRANSCRIPT.md</code> - Execution log</li>
                                </ul>
                            </div>
                            <div class="output-card">
                                <h4>Website</h4>
                                <ul>
                                    <li><code>index.html</code> - Main website</li>
                                    <li><code>styles.css</code> - Dark theme styling</li>
                                    <li><code>workflow.html</code> - This interactive page</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Summary -->
            <div class="workflow-summary">
                <h2>Complete Workflow Summary</h2>
                <div class="summary-stats">
                    <div class="summary-stat">
                        <div class="stat-number">7</div>
                        <div class="stat-label">Major Steps</div>
                    </div>
                    <div class="summary-stat">
                        <div class="stat-number">14+</div>
                        <div class="stat-label">Features Engineered</div>
                    </div>
                    <div class="summary-stat">
                        <div class="stat-number">3</div>
                        <div class="stat-label">ML Models Trained</div>
                    </div>
                    <div class="summary-stat">
                        <div class="stat-number">9</div>
                        <div class="stat-label">Visualizations</div>
                    </div>
                    <div class="summary-stat">
                        <div class="stat-number">32</div>
                        <div class="stat-label">Files Generated</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="workflow-nav">
            <button class="nav-btn" id="prevBtn" onclick="navigateStep(-1)">← Previous</button>
            <button class="nav-btn" id="nextBtn" onclick="navigateStep(1)">Next →</button>
        </div>
    </div>

    <!-- Apply Here Tab Content -->
    <div id="apply-tab" class="tab-content">
        <div class="apply-container">
            <div class="form-container">
                <form id="predictionForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="customer_id">Customer ID</label>
                            <input type="text" id="customer_id" name="customer_id" placeholder="e.g., C001" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="credit_limit">Credit Limit</label>
                            <input type="number" id="credit_limit" name="credit_limit" placeholder="e.g., 165000" min="0" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="utilisation">Utilisation %</label>
                            <input type="number" id="utilisation" name="utilisation" placeholder="e.g., 12" min="0" max="100" step="0.1" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="avg_payment_ratio">Avg Payment Ratio</label>
                            <input type="number" id="avg_payment_ratio" name="avg_payment_ratio" placeholder="e.g., 32" min="0" max="100" step="0.1" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="min_due_frequency">Min Due Paid Frequency %</label>
                            <input type="number" id="min_due_frequency" name="min_due_frequency" placeholder="e.g., 66" min="0" max="100" step="0.1" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="merchant_mix">Merchant Mix Index</label>
                            <input type="number" id="merchant_mix" name="merchant_mix" placeholder="e.g., 0.73" min="0" max="1" step="0.01" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="cash_withdrawal">Cash Withdrawal %</label>
                            <input type="number" id="cash_withdrawal" name="cash_withdrawal" placeholder="e.g., 12" min="0" max="100" step="0.1" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="spend_change">Recent Spend Change %</label>
                            <input type="number" id="spend_change" name="spend_change" placeholder="e.g., -21" min="-100" max="100" step="0.1" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="dpd_bucket">DPD Bucket Next Month (Optional)</label>
                            <input type="number" id="dpd_bucket" name="dpd_bucket" placeholder="e.g., 3 (0-3)" min="0" max="3" step="1">
                            <small style="color: #9ca3af; font-size: 0.75rem; margin-top: 0.25rem;">Leave empty for prediction only</small>
                        </div>
                    </div>
                    
                    <button type="submit" class="submit-btn" id="submitBtn">Predict Risk</button>
                </form>
                
                <div class="loading" id="loading">
                    <p>Processing prediction...</p>
                </div>
                
                <div class="error-message" id="errorMessage"></div>
            </div>

            <div class="result-container" id="resultContainer">
                <div class="result-header">Prediction Results</div>
                
                <div class="result-grid">
                    <div class="result-card" id="riskLevelCard">
                        <div class="result-label">Risk Level</div>
                        <div class="result-value" id="riskLevel">-</div>
                    </div>
                    
                    <div class="result-card">
                        <div class="result-label">Risk Score</div>
                        <div class="result-value" id="riskScore">-</div>
                    </div>
                    
                    <div class="result-card">
                        <div class="result-label">Prediction</div>
                        <div class="result-value" id="prediction">-</div>
                    </div>
                    
                    <div class="result-card">
                        <div class="result-label">Probability</div>
                        <div class="result-value" id="probability">-</div>
                    </div>
                </div>
                
                <div class="risk-flags" id="riskFlags">
                    <h3>Early Warning Flags</h3>
                    <div id="flagsList"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="website/workflow-script.js"></script>
    <script src="website/ml-model-predictor.js"></script>
    <script src="website/apply-script.js"></script>
    <script>
        // Tab switching functionality
        function switchTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName + '-tab').classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
            
            // Scroll to top
            window.scrollTo(0, 0);
        }
        
        // Collapsible flag functionality
        function toggleFlag(element) {
            element.classList.toggle('expanded');
            const icon = element.querySelector('.expand-icon');
            if (element.classList.contains('expanded')) {
                icon.textContent = '▲';
            } else {
                icon.textContent = '▼';
            }
        }
        
        // Dynamic strategy update functionality
        function updateStrategies() {
            // Get values from controls
            const criticalTiming = parseInt(document.getElementById('critical-timing').value);
            const criticalChannel = document.getElementById('critical-channel').value;
            const highTiming = parseInt(document.getElementById('high-timing').value);
            const highChannel = document.getElementById('high-channel').value;
            const mediumTiming = parseInt(document.getElementById('medium-timing').value);
            const mediumChannel = document.getElementById('medium-channel').value;
            
            // Format timing display
            function formatTiming(hours) {
                if (hours < 24) {
                    return `Within ${hours} hour${hours > 1 ? 's' : ''}`;
                } else if (hours < 168) {
                    const days = Math.floor(hours / 24);
                    const remainingHours = hours % 24;
                    if (remainingHours === 0) {
                        return `Within ${days} day${days > 1 ? 's' : ''}`;
                    } else {
                        return `Within ${days} day${days > 1 ? 's' : ''} and ${remainingHours} hour${remainingHours > 1 ? 's' : ''}`;
                    }
                } else {
                    const weeks = Math.floor(hours / 168);
                    const remainingDays = Math.floor((hours % 168) / 24);
                    if (remainingDays === 0) {
                        return `Within ${weeks} week${weeks > 1 ? 's' : ''}`;
                    } else {
                        return `Within ${weeks} week${weeks > 1 ? 's' : ''} and ${remainingDays} day${remainingDays > 1 ? 's' : ''}`;
                    }
                }
            }
            
            // Update displays
            document.getElementById('critical-timing-display').textContent = formatTiming(criticalTiming);
            document.getElementById('critical-channel-display').textContent = criticalChannel;
            document.getElementById('high-timing-display').textContent = formatTiming(highTiming);
            document.getElementById('high-channel-display').textContent = highChannel;
            document.getElementById('medium-timing-display').textContent = formatTiming(mediumTiming);
            document.getElementById('medium-channel-display').textContent = mediumChannel;
        }
        
        // Reset to defaults
        function resetStrategies() {
            document.getElementById('critical-timing').value = 24;
            document.getElementById('critical-channel').value = 'Phone Call';
            document.getElementById('high-timing').value = 48;
            document.getElementById('high-channel').value = 'Phone Call or Email';
            document.getElementById('medium-timing').value = 168;
            document.getElementById('medium-channel').value = 'Email or SMS';
            updateStrategies();
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            updateStrategies();
        });
    </script>
</body>
</html>
